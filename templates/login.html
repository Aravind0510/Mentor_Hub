{% extends "base.html" %}

{% block title %}Login - Mentor Hub{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-background">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <div class="login-card glass-card">
        <div class="login-header">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>Mentor Hub</span>
            </div>
            <h1>Welcome Back</h1>
            <p>Sign in to continue to your dashboard</p>
        </div>

        <form id="loginForm" class="login-form">
            <div class="form-group">
                <label for="email">
                    <i class="fas fa-envelope"></i>
                    Email Address
                </label>
                <input type="email" id="email" name="email" placeholder="Enter your email" required>
            </div>

            <div class="form-group">
                <label for="password">
                    <i class="fas fa-lock"></i>
                    Password
                </label>
                <div class="password-input">
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                    <button type="button" class="toggle-password" onclick="togglePassword()">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>

            <div id="errorMessage" class="error-message" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <span></span>
            </div>

            <button type="submit" class="btn btn-primary btn-block">
                <span>Sign In</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </form>

        <div class="login-footer">
            <button class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
                <span>Dark Mode</span>
            </button>
        </div>

        <div class="demo-credentials">
            <h4>Demo Credentials</h4>
            <div class="credential-list">
                <div class="credential-item" onclick="fillCredentials('admin@eduplatform.com', 'admin123')">
                    <span class="role-badge admin">Admin</span>
                    <span>admin@eduplatform.com</span>
                </div>
                <div class="credential-item" onclick="fillCredentials('mentor1@eduplatform.com', 'mentor123')">
                    <span class="role-badge mentor">Mentor</span>
                    <span>mentor1@eduplatform.com</span>
                </div>
                <div class="credential-item" onclick="fillCredentials('student1@eduplatform.com', 'student123')">
                    <span class="role-badge student">Student</span>
                    <span>student1@eduplatform.com</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function togglePassword() {
        const passwordInput = document.getElementById('password');
        const icon = document.querySelector('.toggle-password i');

        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    function fillCredentials(email, password) {
        document.getElementById('email').value = email;
        document.getElementById('password').value = password;
    }

    document.getElementById('loginForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const errorMessage = document.getElementById('errorMessage');
        const submitBtn = this.querySelector('button[type="submit"]');

        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing in...';

        try {
            const response = await fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email, password })
            });

            const data = await response.json();

            if (data.success) {
                window.location.href = data.redirect;
            } else {
                errorMessage.style.display = 'flex';
                errorMessage.querySelector('span').textContent = data.message || 'Invalid credentials';
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<span>Sign In</span><i class="fas fa-arrow-right"></i>';
            }
        } catch (error) {
            errorMessage.style.display = 'flex';
            errorMessage.querySelector('span').textContent = 'An error occurred. Please try again.';
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<span>Sign In</span><i class="fas fa-arrow-right"></i>';
        }
    });
</script>
{% endblock %}
